<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="General-purpose transactions pool."><title>smoldot::transactions::pool - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="smoldot" data-themes="" data-resource-suffix="" data-rustdoc-version="1.92.0 (ded5c06cf 2025-12-08)" data-channel="1.92.0" data-search-js="search-d69d8955.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-ce535bd0.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module pool</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../smoldot/index.html">smoldot</a><span class="version">0.21.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module pool</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#overview" title="Overview">Overview</a></li><li><a href="#usage" title="Usage">Usage</a></li><li><a href="#out-of-scope" title="Out of scope">Out of scope</a></li></ul><h3><a href="#reexports">Module Items</a></h3><ul class="block"><li><a href="#reexports" title="Re-exports">Re-exports</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In smoldot::<wbr>transactions</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">smoldot</a>::<wbr><a href="../index.html">transactions</a></div><h1>Module <span>pool</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/smoldot/transactions/pool.rs.html#18-897">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>General-purpose transactions pool.</p>
<p>The transactions pool is a complex data structure that holds a list of pending transactions,
in other words transactions that should later be included in blocks, and a list of
transactions that have been included in non-finalized blocks.</p>
<p>See the <a href="..">parent module’s documentation</a> for an overview of transactions.</p>
<h2 id="overview"><a class="doc-anchor" href="#overview">§</a>Overview</h2>
<p>The transactions pool stores a list of transactions that the local node desires to include in
blocks, and a list of transactions that have already been included in blocks. Each of these
transactions is either validated or not. A transaction in a block is assumed to always succeed
validation. A validated transaction that isn’t present in any block is a transaction that is
assumed to be includable in a block in the future.</p>
<p>The order in which transactions can be included in a block follows a complex system of
“provided” and “required” tags. A transaction that <em>requires</em> some tags can only be included
after all these tags have been <em>provided</em> by transactions earlier in the chain.</p>
<p>The transactions pool isn’t only about deciding which transactions to include in a block when
authoring, but also about tracking the status of interesting transactions between the moment
they become interesting and the moment the block they are included in becomes finalized. This
is relevant both if the local node can potentially author blocks or not.</p>
<p>The transactions pool tracks the height of the <em>best</em> chain, and only of the best chain. More
precisely, it is aware of the height of the current best block. Forks are tracked.</p>
<h2 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h2>
<p>A <a href="struct.Pool.html" title="struct smoldot::transactions::pool::Pool"><code>Pool</code></a> is a collection of transactions. Each transaction in the pool exposes three
properties:</p>
<ul>
<li>Whether or not it has been validated, and if yes, the block against which it has been
validated and the characteristics of the transaction (as provided by the runtime). These
characterstics are: the tags it provides and requires, its longevity, and its priority.
See <a href="../validate">the <code>validate</code> module</a> for more information.</li>
<li>The height of the block, if any, in which the transaction has been included.</li>
<li>A so-called user data, an opaque field controlled by the API user.</li>
</ul>
<p>Use <a href="struct.Pool.html#method.add_unvalidated" title="method smoldot::transactions::pool::Pool::add_unvalidated"><code>Pool::add_unvalidated</code></a> to add to the pool a transaction that should be included in a
block at a later point in time.</p>
<p>When a new block is considered as best, use <a href="struct.Pool.html#method.retract_blocks" title="method smoldot::transactions::pool::Pool::retract_blocks"><code>Pool::retract_blocks</code></a> to remove all the re-orged
blocks, then <a href="struct.Pool.html#method.append_empty_block" title="method smoldot::transactions::pool::Pool::append_empty_block"><code>Pool::append_empty_block</code></a> and
<a href="struct.Pool.html#method.best_block_add_transaction_by_scale_encoding" title="method smoldot::transactions::pool::Pool::best_block_add_transaction_by_scale_encoding"><code>Pool::best_block_add_transaction_by_scale_encoding</code></a> to add the new block(s). The
transactions that are passed to <a href="struct.Pool.html#method.best_block_add_transaction_by_scale_encoding" title="method smoldot::transactions::pool::Pool::best_block_add_transaction_by_scale_encoding"><code>Pool::best_block_add_transaction_by_scale_encoding</code></a> are
added to the pool.</p>
<p>Use <a href="struct.Pool.html#method.unvalidated_transactions" title="method smoldot::transactions::pool::Pool::unvalidated_transactions"><code>Pool::unvalidated_transactions</code></a> to obtain the list of transactions that should be
validated. Validation should be performed using the <a href="../validate"><code>validate</code></a> module, and
the result reported with <a href="struct.Pool.html#method.set_validation_result" title="method smoldot::transactions::pool::Pool::set_validation_result"><code>Pool::set_validation_result</code></a>.</p>
<p>Use <a href="struct.Pool.html#method.remove_included" title="method smoldot::transactions::pool::Pool::remove_included"><code>Pool::remove_included</code></a> when a block has been finalized to remove from the pool the
transactions that are present in the finalized block and below.</p>
<p>When authoring a block, use <a href="struct.Pool.html#method.append_empty_block" title="method smoldot::transactions::pool::Pool::append_empty_block"><code>Pool::append_empty_block</code></a> and
<a href="struct.Pool.html#method.best_block_includable_transactions" title="method smoldot::transactions::pool::Pool::best_block_includable_transactions"><code>Pool::best_block_includable_transactions</code></a> to determine which transaction to include
next. Use <a href="struct.Pool.html#method.best_block_add_transaction_by_id" title="method smoldot::transactions::pool::Pool::best_block_add_transaction_by_id"><code>Pool::best_block_add_transaction_by_id</code></a> when the transaction has been included.</p>
<h2 id="out-of-scope"><a class="doc-anchor" href="#out-of-scope">§</a>Out of scope</h2>
<p>The following are examples of things that are related transactions pool to but out of scope of
this data structure:</p>
<ul>
<li>Watching the state of transactions.</li>
<li>Sending transactions to other peers.</li>
</ul>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><dl class="item-table reexports"><dt id="reexport.ValidTransaction"><code>pub use super::validate::<a class="struct" href="../validate/struct.ValidTransaction.html" title="struct smoldot::transactions::validate::ValidTransaction">ValidTransaction</a>;</code></dt></dl><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.Config.html" title="struct smoldot::transactions::pool::Config">Config</a></dt><dd>Configuration for <a href="struct.Pool.html#method.new" title="associated function smoldot::transactions::pool::Pool::new"><code>Pool::new</code></a>.</dd><dt><a class="struct" href="struct.Pool.html" title="struct smoldot::transactions::pool::Pool">Pool</a></dt><dd>Data structure containing transactions. See the module-level documentation for more info.</dd><dt><a class="struct" href="struct.TransactionId.html" title="struct smoldot::transactions::pool::TransactionId">Transaction<wbr>Id</a></dt><dd>Identifier of a transaction stored within the <a href="struct.Pool.html" title="struct smoldot::transactions::pool::Pool"><code>Pool</code></a>.</dd><dt><a class="struct" href="struct.Vacant.html" title="struct smoldot::transactions::pool::Vacant">Vacant</a></dt><dd>See <a href="enum.AppendBlockTransaction.html#variant.Unknown" title="variant smoldot::transactions::pool::AppendBlockTransaction::Unknown"><code>AppendBlockTransaction::Unknown</code></a>.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.AppendBlockTransaction.html" title="enum smoldot::transactions::pool::AppendBlockTransaction">Append<wbr>Block<wbr>Transaction</a></dt><dd>See <a href="struct.Pool.html#method.best_block_add_transaction_by_scale_encoding" title="method smoldot::transactions::pool::Pool::best_block_add_transaction_by_scale_encoding"><code>Pool::best_block_add_transaction_by_scale_encoding</code></a>.</dd></dl></section></div></main></body></html>